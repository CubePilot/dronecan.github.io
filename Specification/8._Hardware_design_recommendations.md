---
permalink: /Specification/8._Hardware_design_recommendations/
---

# Hardware design recommendations

Points concerning hardware design are listed here.
Though they are not mandatory to follow, they are recommended for consideration to ensure interoperability
of UAVCAN-compatible devices from different vendors.

## Physical connector definition

This standard defines the following connector types, though the specification can be extended later
with other connectors.
It is highly recommended to use only connectors specified below to ensure compatibility.

The following table provides a summarized overview of all of the supported connector types.
They are reviewed in more detail later.

Name                |Base connector type        |Positions  |Bus supply voltage |Max current|Known compatible standards (the list is non-exhaustive)
--------------------|---------------------------|-----------|-------------------|-----------|--------------------------
**UAVCAN D-Sub**    |Generic D-Subminiature     |9          |24 V               |3 A        |De-facto standard connector for CAN, supported by many current specifications
**UAVCAN M8**       |Generic circular M8 B-coded|5          |24 V               |1.5 A      |CANopen
**UAVCAN Micro**    |JST JH                     |4          |5 V                |1 A        |Dronecode Autopilot Connector Standard

### UAVCAN D-Sub connector

Industry-standard CAN connector with compatible pinout. Offers best compatibility with existing hardware. Not recommended for space-sensitive applications.

Pros: Highly compatible, reliable, industry standard.

Cons: Huge.

### UAVCAN M8 connector

Industry-standard CAN connector with compatible pinout. Recommended for mission-critical applications, where high reliability is expected.

Pros: Reliable, compact, industry standard.

### UAVCAN Micro connector

{% include lightbox.html url="/Specification/figures/jst_gh_patch_cable.jpg" title="UAVCAN Micro patch non-twisted cable" thumbnail=true %}
{% include lightbox.html url="/Specification/figures/jst_gh_termination_plug.jpg" title="UAVCAN Micro termination plug" thumbnail=true %}
{% include lightbox.html url="/Specification/figures/jst_gh_1st_pin_mark.png" title="Location of the first pin of a JST GH plug is indicated with a mark, as shown on the figure" thumbnail=true %}

The Micro connector is intended for weight- and space-sensitive applications.
It is a board-level connector, meaning that it can be installed on the PCB rather than on the panel.

UAVCAN Micro connector is compatible with the Dronecode Autopilot Connector Standard.
This connector type is recommended for small UAV and nanosatellites.
It is also the recommended connector type for attaching external panel-mounted connectors
(such as the M8 or D-Sub types) to the PCB inside the enclosure.

#### Advantages

* Extremely compact, low-profile. The PCB footprint is under 9✕5 millimeters.
* Secure positive lock ensures that the connection will not self-disconnect when exposed to vibrations.
* Low-cost, easy to stock.

#### Disadvantages

* Board-level connections only. No panel-mounted options available.
* No shielding available.
* Not suitable for safety-critical hardware.

#### Specification

The Micro connector is based on the proprietary [JST GH](http://www.jst-mfg.com/product/pdf/eng/eGH.pdf)
4-position connector type.

The suitable cable types are flat or twisted pair #30 to #26 AWG, outer insulation diameter 0.8---1.0 mm,
multi-strand.
Non-twisted (flat) cables can only be used in very small deployments free of significant EMI,
otherwise reliable functioning of the bus cannot be guaranteed.

The CAN physical layer standard that can be used with this connector type is
[ISO 11898-2](http://www.can-cia.org/index.php?id=systemdesign-can-physicallayer#high),
also known as high-speed CAN.

Nodes that deliver power to the bus are required to provide 5.0---5.5 V on the bus power line.
The anticipated current draw is up to 1 A per connector.

Nodes that are powered from the bus should expect 4.0---5.5 V on the bus power line.
The maximum recommended current draw from the bus is 500 mA per node.

Circuit number  | Function          | Recommended wire designation for 25-pair-color-coded cables
----------------|-------------------|----------------------------------------------------------------------------------
1               | Bus power supply  | <img src="/Specification/figures/wire_white_blue_stripe.svg"   style="width:4em;" /> pair 1 tip
2               | CAN High          | <img src="/Specification/figures/wire_orange.svg"              style="width:4em;" /> pair 2 ring
3               | CAN Low           | <img src="/Specification/figures/wire_white_orange_stripe.svg" style="width:4em;" /> pair 2 tip
4               | GND               | <img src="/Specification/figures/wire_blue.svg"                style="width:4em;" /> pair 1 ring

## Design recommendations

### Connectors

{% include lightbox.html url="/Specification/figures/can_phy_power_reference.png" title="Power supply reference schematic" thumbnail=true %}

It is highly recommended to provide two identical connectors per each CAN interface per node,
so that the node can be connected to the bus without need to use T-connectors.
T-connectors should be avoided when possible because generally they add an extra point of failure
and increase the stub length and weight.

### Power supply

Each power input must be protected with an overcurrent protection circuit (e.g. fuse),
so that an occasional short circuit on the device will not bring down the power on the entire bus.
If a device incorporates redundant bus interfaces, it must prevent direct current flow between power inputs
from different interface connectors, so that if one bus suffers a power failure (e.g. short circuit)
it won’t be propagated to other buses.

### Nodes with different number of redundant interfaces

Mission critical nodes and non-mission critical nodes often may need to co-exist on the same UAVCAN network.
Non-mission critical nodes are likely to be equipped with non-redundant CAN bus interface,
which often creates a situation when multiple nodes with different number of redundant interfaces need to be
connected to the same UAVCAN network.

If multiple nodes with different number of interfaces need to co-exist on the same UAVCAN network,
the following rules should be followed:

* Each available CAN bus (UAVCAN supports up to 3) is assigned a level of importance (primary or backup).
* All nodes should be connected to the primary CAN bus.
* Only nodes with redundant interfaces should be also connected to the backup bus/buses.

The figure below shows a doubly redundant CAN bus, but the same considerations apply to a triply redundant bus:

{% include lightbox.html url="/Specification/figures/redundant_can_bus.png" title="Redundant CAN bus" %}

### CAN bus parameters

UAVCAN is bit rate agnostic, so technically any bit rate can be used as long as it is supported by the physical layer.
However, only recommended bit rates from the table below should be used to ensure compatibility.

All recommended bit rates and other relevant CAN bus parameters are listed in the table below.

Bit rate             | Valid range for location of sample point | Recommended location of sample point | Max bus length | Max stub length
---------------------|------------------------------------------|--------------------------------------|----------------|----------------
1000 kbit/s          | 75% to 90%                               | 87.5%                                | 25 m           | 0.3 m
500 kbit/s           | 85% to 90%                               | 87.5%                                | 100 m          | 0.3 m
250 kbit/s           | 85% to 90%                               | 87.5%                                | 250 m          | 0.3 m
125 kbit/s           | 85% to 90%                               | 87.5%                                | 500 m          | 0.3 m

The estimated bus length limits are based on the assumption that propagation delay does not exceed 5 ns/m,
not including additional delay times of CAN transceivers and other components.

#### Automatic bit rate detection

It is encouraged to implement CAN auto bauding when applicable.
Please refer to the CiA 801 application note for recommended practices.

It should be noted that UAVCAN enables the use of the simple bit time measuring approach,
as it is guaranteed that any functioning UAVCAN network will always contain node status message,
which can be expected to be published at a rate no lower than 1 Hz,
and that contains a suitable alternating bit pattern in the CAN ID field.
Please refer to the [chapter dedicated to standard data types](/Specification/6._Application_level_functions)
for details.

## See also

* <http://www.ti.com/lit/an/slla270/slla270.pdf>
* <http://www.computer-solutions.co.uk/info/Embedded_tutorials/can_tutorial.htm>
